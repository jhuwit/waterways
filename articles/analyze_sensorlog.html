<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Analysis of SensorLog Data • waterways</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Analysis of SensorLog Data">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">waterways</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/analyze_sensorlog.html">Analysis of SensorLog Data</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Analysis of SensorLog Data</h1>
            
      

      <div class="d-none name"><code>analyze_sensorlog.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>In this vignette, we will go through the steps on how to analyze
SensorLog data. We will go through the steps of reading in the data,
checking for potential duplicates of timestamps, calculating distance
metrics from a fixed point (commonly participant home), and creating
daily summaries.</p>
<p>We will also integrate ActiGraph data to show activity at different
distances.</p>
</div>
<div class="section level2">
<h2 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a>
</h2>
<div class="section level3">
<h3 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h3>
<p>The data used is example data embedded in the waterways package. It
is a single participant for approximately two hours worth of GPS and
activity data. The SensorLog data is stored in a zip file and contains a
single CSV file. The data is stored in the <code>extdata</code> folder
of the package. We can get the path of the file on each user’s machines
using <code>system.file</code> and the package name:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://jhuwit.github.io/waterways/">waterways</a></span><span class="op">)</span></span>
<span><span class="va">file</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span></span>
<span>  <span class="st">"extdata"</span>, <span class="st">"SensorLogFiles_my_iOS_device_250311_14-55-58.zip"</span>,</span>
<span>  package <span class="op">=</span> <span class="st">"waterways"</span><span class="op">)</span></span>
<span><span class="va">file</span></span>
<span><span class="co">#&gt; [1] "/home/runner/work/_temp/Library/waterways/extdata/SensorLogFiles_my_iOS_device_250311_14-55-58.zip"</span></span></code></pre></div>
<p>This can also be done using the wrapper from
<code>waterways</code>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ww_example_data.html">ww_example_sensorlog_file</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "/home/runner/work/_temp/Library/waterways/extdata/SensorLogFiles_my_iOS_device_250311_14-55-58.zip"</span></span></code></pre></div>
<div class="section level4">
<h4 id="reading-in-the-data">Reading in the data<a class="anchor" aria-label="anchor" href="#reading-in-the-data"></a>
</h4>
<p>The data is read in using the <code>ww_read_sensorlog</code>
function:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">=</span> <span class="fu"><a href="../reference/ww_read_sensorlog.html">ww_read_sensorlog</a></span><span class="op">(</span><span class="va">file</span>, robust <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">=</span> <span class="va">df</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">file</span><span class="op">)</span> <span class="co"># we don't need to see which file this came from</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 13</span></span></span>
<span><span class="co">#&gt;   time         index timestamp   lat   lon altitude speed speed_accuracy accel_X</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 2025-03-11T…     1    1.74<span style="color: #949494;">e</span>9  39.3 -<span style="color: #BB0000;">76.6</span>     46.3    -<span style="color: #BB0000;">1</span>             -<span style="color: #BB0000;">1</span>  0.411 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 2025-03-11T…     2    1.74<span style="color: #949494;">e</span>9  39.3 -<span style="color: #BB0000;">76.6</span>     46.3    -<span style="color: #BB0000;">1</span>             -<span style="color: #BB0000;">1</span>  0.090<span style="text-decoration: underline;">8</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 2025-03-11T…     3    1.74<span style="color: #949494;">e</span>9  39.3 -<span style="color: #BB0000;">76.6</span>     46.3    -<span style="color: #BB0000;">1</span>             -<span style="color: #BB0000;">1</span>  0.125 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 2025-03-11T…     4    1.74<span style="color: #949494;">e</span>9  39.3 -<span style="color: #BB0000;">76.6</span>     46.3    -<span style="color: #BB0000;">1</span>             -<span style="color: #BB0000;">1</span>  0.063<span style="text-decoration: underline;">6</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 2025-03-11T…     5    1.74<span style="color: #949494;">e</span>9  39.3 -<span style="color: #BB0000;">76.6</span>     46.3    -<span style="color: #BB0000;">1</span>             -<span style="color: #BB0000;">1</span>  0.099<span style="text-decoration: underline;">3</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 2025-03-11T…     6    1.74<span style="color: #949494;">e</span>9  39.3 -<span style="color: #BB0000;">76.6</span>     46.3    -<span style="color: #BB0000;">1</span>             -<span style="color: #BB0000;">1</span>  0.070<span style="text-decoration: underline;">2</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 4 more variables: accel_Y &lt;dbl&gt;, accel_Z &lt;dbl&gt;, lat_zero &lt;lgl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   lon_zero &lt;lgl&gt;</span></span></span></code></pre></div>
<p>The option <code>robust</code> will run
<code>rewrite_sensorlog_csv</code> is run on the data. The
<code>rewrite_sensorlog_csv</code> attempts to fix any shifts with the
data, which have been seen due to a bug in the iOS app. The option
default is <code>FALSE</code> because this can take a much longer time
to read in the data due to reading and writing the data back out to a
temporary file. This function will also flag any values of latitude and
longitude that are 0 (absolute value
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&lt;</mo><mn>0.00001</mn></mrow><annotation encoding="application/x-tex">&lt; 0.00001</annotation></semantics></math>).
This flag is created because the iOS app will sometimes record 0 for
latitude and longitude when the GPS signal is lost.</p>
<p>We see that the data has the following columns, which are renamed
from the original data.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "time"           "index"          "timestamp"      "lat"           </span></span>
<span><span class="co">#&gt;  [5] "lon"            "altitude"       "speed"          "speed_accuracy"</span></span>
<span><span class="co">#&gt;  [9] "accel_X"        "accel_Y"        "accel_Z"        "lat_zero"      </span></span>
<span><span class="co">#&gt; [13] "lon_zero"</span></span></code></pre></div>
<p>The mapping from the new column names from the original column names
can be seen using <code>ww_sensorlog_csv_colnames_mapping</code>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ww_read_sensorlog.html">ww_sensorlog_csv_colnames_mapping</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;                             time                            index </span></span>
<span><span class="co">#&gt;               "loggingTime(txt)"               "loggingSample(N)" </span></span>
<span><span class="co">#&gt;                        timestamp                              lat </span></span>
<span><span class="co">#&gt; "locationTimestamp_since1970(s)"        "locationLatitude(WGS84)" </span></span>
<span><span class="co">#&gt;                              lon                         altitude </span></span>
<span><span class="co">#&gt;       "locationLongitude(WGS84)"            "locationAltitude(m)" </span></span>
<span><span class="co">#&gt;                            speed                   speed_accuracy </span></span>
<span><span class="co">#&gt;             "locationSpeed(m/s)"     "locationSpeedAccuracy(m/s)" </span></span>
<span><span class="co">#&gt;                          accel_X                          accel_Y </span></span>
<span><span class="co">#&gt;  "accelerometerAccelerationX(G)"  "accelerometerAccelerationY(G)" </span></span>
<span><span class="co">#&gt;                          accel_Z </span></span>
<span><span class="co">#&gt;  "accelerometerAccelerationZ(G)"</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="processing-the-data">Processing the data<a class="anchor" aria-label="anchor" href="#processing-the-data"></a>
</h4>
<p>The data is then processed using the
<code>ww_process_sensorlog</code> function. This function (currently)
will:</p>
<ol style="list-style-type: decimal">
<li>Check the data for duplicated data using
<code>ww_check_data</code>.</li>
<li>Calculate distance from a central point if provided using
<code>ww_calculate_distance</code>
</li>
<li>Process the timing data using <code>ww_process_time</code>,
including checking for duplicate times. This function will also
determine if the data is in the correct timezone by estimating the
timezone expected (in the <code>expected_timezone</code> field, set to
<code>America/New_York</code>) based the GPS coordinates, using the
<code><a href="http://andyteucher.ca/lutz/reference/tz_lookup_coords.html" class="external-link">lutz::tz_lookup_coords</a></code> function. If this check is not
desired, set <code>expected_timezone = NULL</code>:</li>
</ol>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ww_process_sensorlog.html">ww_process_sensorlog</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="co">#&gt; No duplicate combinations found of: time, timestamp, lat, lon, altitude, speed, speed_accuracy, accel_X, accel_Y, ... and 3 other variables</span></span>
<span><span class="co">#&gt; Error in ww_check_data(data, remove_cols = remove_cols): anyDuplicated(data$time) == 0 is not TRUE</span></span></code></pre></div>
<p>As the error indicates, there are some duplicate times in this file.
We can look at those specific duplicate times and see that even to 3
digits for milliseconds, there are multiple measurements:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">add_count</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">n</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">lat</span>, <span class="va">lon</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"accel"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 8 × 6</span></span></span>
<span><span class="co">#&gt;   time                            lat   lon accel_X accel_Y  accel_Z</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 2025-03-11T14:44:14.795-04:00  39.3 -<span style="color: #BB0000;">76.6</span> -<span style="color: #BB0000;">0.705</span>    0.891  0.427  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 2025-03-11T14:44:14.795-04:00  39.3 -<span style="color: #BB0000;">76.6</span> -<span style="color: #BB0000;">1.02</span>     0.667  0.405  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 2025-03-11T14:44:14.795-04:00  39.3 -<span style="color: #BB0000;">76.6</span> -<span style="color: #BB0000;">0.641</span>    0.833 -<span style="color: #BB0000;">0.096</span><span style="color: #BB0000; text-decoration: underline;">1</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 2025-03-11T14:44:14.796-04:00  39.3 -<span style="color: #BB0000;">76.6</span> -<span style="color: #BB0000;">0.989</span>    0.441  0.026<span style="text-decoration: underline;">3</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 2025-03-11T14:44:14.796-04:00  39.3 -<span style="color: #BB0000;">76.6</span> -<span style="color: #BB0000;">0.808</span>    0.591 -<span style="color: #BB0000;">0.006</span><span style="color: #BB0000; text-decoration: underline;">47</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 2025-03-11T14:44:14.796-04:00  39.3 -<span style="color: #BB0000;">76.6</span> -<span style="color: #BB0000;">0.213</span>    0.354 -<span style="color: #BB0000;">0.078</span><span style="color: #BB0000; text-decoration: underline;">7</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span> 2025-03-11T14:44:14.797-04:00  39.3 -<span style="color: #BB0000;">76.6</span> -<span style="color: #BB0000;">0.017</span><span style="color: #BB0000; text-decoration: underline;">9</span>   0.432 -<span style="color: #BB0000;">0.082</span><span style="color: #BB0000; text-decoration: underline;">0</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">8</span> 2025-03-11T14:44:14.797-04:00  39.3 -<span style="color: #BB0000;">76.6</span>  0.061<span style="text-decoration: underline;">1</span>   0.418  0.077<span style="text-decoration: underline;">0</span></span></span></code></pre></div>
<p>Thus, we do not want to ensure no duplicated times, so we will set
<code>check_data</code> to be <code>FALSE</code>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">=</span> <span class="fu"><a href="../reference/ww_process_sensorlog.html">ww_process_sensorlog</a></span><span class="op">(</span><span class="va">df</span>, check_data <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">df</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 11,578 × 15</span></span></span>
<span><span class="co">#&gt;    time                index timestamp             lat   lon altitude speed</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 2025-03-11 <span style="color: #949494;">18:44:11</span>     1 2025-03-11 <span style="color: #949494;">18:44:07</span>  39.3 -<span style="color: #BB0000;">76.6</span>     46.3    -<span style="color: #BB0000;">1</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 2025-03-11 <span style="color: #949494;">18:44:11</span>     2 2025-03-11 <span style="color: #949494;">18:44:07</span>  39.3 -<span style="color: #BB0000;">76.6</span>     46.3    -<span style="color: #BB0000;">1</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 2025-03-11 <span style="color: #949494;">18:44:11</span>     3 2025-03-11 <span style="color: #949494;">18:44:07</span>  39.3 -<span style="color: #BB0000;">76.6</span>     46.3    -<span style="color: #BB0000;">1</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 2025-03-11 <span style="color: #949494;">18:44:12</span>     4 2025-03-11 <span style="color: #949494;">18:44:07</span>  39.3 -<span style="color: #BB0000;">76.6</span>     46.3    -<span style="color: #BB0000;">1</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 2025-03-11 <span style="color: #949494;">18:44:12</span>     5 2025-03-11 <span style="color: #949494;">18:44:07</span>  39.3 -<span style="color: #BB0000;">76.6</span>     46.3    -<span style="color: #BB0000;">1</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 2025-03-11 <span style="color: #949494;">18:44:12</span>     6 2025-03-11 <span style="color: #949494;">18:44:07</span>  39.3 -<span style="color: #BB0000;">76.6</span>     46.3    -<span style="color: #BB0000;">1</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 2025-03-11 <span style="color: #949494;">18:44:12</span>     7 2025-03-11 <span style="color: #949494;">18:44:07</span>  39.3 -<span style="color: #BB0000;">76.6</span>     46.3    -<span style="color: #BB0000;">1</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 2025-03-11 <span style="color: #949494;">18:44:12</span>     8 2025-03-11 <span style="color: #949494;">18:44:07</span>  39.3 -<span style="color: #BB0000;">76.6</span>     46.3    -<span style="color: #BB0000;">1</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 2025-03-11 <span style="color: #949494;">18:44:12</span>     9 2025-03-11 <span style="color: #949494;">18:44:07</span>  39.3 -<span style="color: #BB0000;">76.6</span>     46.3    -<span style="color: #BB0000;">1</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 2025-03-11 <span style="color: #949494;">18:44:12</span>    10 2025-03-11 <span style="color: #949494;">18:44:07</span>  39.3 -<span style="color: #BB0000;">76.6</span>     46.3    -<span style="color: #BB0000;">1</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 11,568 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 8 more variables: speed_accuracy &lt;dbl&gt;, accel_X &lt;dbl&gt;, accel_Y &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   accel_Z &lt;dbl&gt;, lat_zero &lt;lgl&gt;, lon_zero &lt;lgl&gt;, timezone_estimated &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   char_time &lt;chr&gt;</span></span></span></code></pre></div>
<p>The data times will be projected into the <code>GMT</code> timezone
to agree with the output from ActiGraph and
<code><a href="https://rdrr.io/pkg/read.gt3x/man/read.gt3x.html" class="external-link">read.gt3x::read.gt3x</a></code>. <strong>NOTE:</strong> this shifts
times from the original timezone. For example, if the data was at
“2025-03-25 14:14:00” with a timezone of <code>-04:00</code> then the
data will be in the <code>GMT</code> timezone, but the printed time will
be “2025-03-25 18:14:00 GMT”. You can set the timezone to the correct
timezone using <code><a href="https://lubridate.tidyverse.org/reference/with_tz.html" class="external-link">lubridate::with_tz</a></code> or
<code><a href="https://lubridate.tidyverse.org/reference/force_tz.html" class="external-link">lubridate::force_tz</a></code> (they have different behavior).</p>
<p>You can also pass in the <code>tz = "EST"</code> argument to
<code>ww_process_sensorlog</code>, which is passed to
<code>ww_process_time</code>. An additional column of
<code>char_time</code> is added so that the original character values fo
the time are retained so that users can check any timezone conversions,
as they can lead to issues with merging data, determining windows
(e.g. wake), or other time-based analyses.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">char_time</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 2</span></span></span>
<span><span class="co">#&gt;   time                char_time                    </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 2025-03-11 <span style="color: #949494;">18:44:11</span> 2025-03-11T14:44:11.899-04:00</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 2025-03-11 <span style="color: #949494;">18:44:11</span> 2025-03-11T14:44:11.938-04:00</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 2025-03-11 <span style="color: #949494;">18:44:11</span> 2025-03-11T14:44:11.998-04:00</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 2025-03-11 <span style="color: #949494;">18:44:12</span> 2025-03-11T14:44:12.058-04:00</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 2025-03-11 <span style="color: #949494;">18:44:12</span> 2025-03-11T14:44:12.117-04:00</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 2025-03-11 <span style="color: #949494;">18:44:12</span> 2025-03-11T14:44:12.177-04:00</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="calculating-distance">Calculating distance<a class="anchor" aria-label="anchor" href="#calculating-distance"></a>
</h4>
<p>We did not pass in the latitude and longitude of a fixed point to
calculate distance for the processing function, but we could have. We
can also calculate the distance separately using the function
<code>ww_calculate_distance</code>. First, we need to get the latitude
and longitude of the fixed point. We can use the
<code>tidygeocoder</code> package to get the latitude and longitude of a
fixed point. We will use the address
<code>615 N Wolfe St, Baltimore MD</code> for the Johns Hopkins
Bloomberg School of Public Health where this data was collected, using
the <a href="https://geocoding.geo.census.gov/geocoder/" class="external-link">Census
Geocoder</a> for free:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">geo</span> <span class="op">=</span> <span class="fu">tidygeocoder</span><span class="fu">::</span><span class="fu"><a href="https://jessecambon.github.io/tidygeocoder/reference/geo.html" class="external-link">geo</a></span><span class="op">(</span><span class="st">"615 N Wolfe St, Baltimore MD"</span>, method <span class="op">=</span> <span class="st">"census"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">geo</span><span class="op">)</span></span>
<span><span class="va">lat</span> <span class="op">=</span> <span class="va">geo</span><span class="op">$</span><span class="va">lat</span></span>
<span><span class="va">lon</span> <span class="op">=</span> <span class="va">geo</span><span class="op">$</span><span class="va">long</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 3</span></span></span>
<span><span class="co">#&gt;   address                        lat  long</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 615 N Wolfe St, Baltimore MD  39.3 -<span style="color: #BB0000;">76.6</span></span></span></code></pre>
<p>We can then calculate the distance from this fixed point using the
<code>ww_calculate_distance</code> function:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">=</span> <span class="fu"><a href="../reference/ww_process_sensorlog.html">ww_calculate_distance</a></span><span class="op">(</span><span class="va">df</span>,</span>
<span>                           lat <span class="op">=</span> <span class="va">lat</span>,</span>
<span>                           lon <span class="op">=</span> <span class="va">lon</span><span class="op">)</span></span></code></pre></div>
<p>This function uses the <code><a href="https://rdrr.io/pkg/geosphere/man/distm.html" class="external-link">geosphere::distm</a></code> function to
calculate the distance in meters from the fixed point. We can see the
new columns that were added to the data.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">char_time</span>, <span class="va">lat_zero</span>, <span class="va">lon_zero</span>, <span class="va">distance</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 11,578 × 5</span></span></span>
<span><span class="co">#&gt;    time                char_time                     lat_zero lon_zero distance</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                         <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 2025-03-11 <span style="color: #949494;">18:44:11</span> 2025-03-11T14:44:11.899-04:00 FALSE    FALSE        73.4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 2025-03-11 <span style="color: #949494;">18:44:11</span> 2025-03-11T14:44:11.938-04:00 FALSE    FALSE        73.4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 2025-03-11 <span style="color: #949494;">18:44:11</span> 2025-03-11T14:44:11.998-04:00 FALSE    FALSE        73.4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 2025-03-11 <span style="color: #949494;">18:44:12</span> 2025-03-11T14:44:12.058-04:00 FALSE    FALSE        73.4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 2025-03-11 <span style="color: #949494;">18:44:12</span> 2025-03-11T14:44:12.117-04:00 FALSE    FALSE        73.4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 2025-03-11 <span style="color: #949494;">18:44:12</span> 2025-03-11T14:44:12.177-04:00 FALSE    FALSE        73.4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 2025-03-11 <span style="color: #949494;">18:44:12</span> 2025-03-11T14:44:12.236-04:00 FALSE    FALSE        73.4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 2025-03-11 <span style="color: #949494;">18:44:12</span> 2025-03-11T14:44:12.296-04:00 FALSE    FALSE        73.4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 2025-03-11 <span style="color: #949494;">18:44:12</span> 2025-03-11T14:44:12.356-04:00 FALSE    FALSE        73.4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 2025-03-11 <span style="color: #949494;">18:44:12</span> 2025-03-11T14:44:12.415-04:00 FALSE    FALSE        73.4</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 11,568 more rows</span></span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="summarizing-the-data">Summarizing the Data<a class="anchor" aria-label="anchor" href="#summarizing-the-data"></a>
</h3>
<p>Now that we have the distance for each point in time, we can
summarize the data. In many cases, we do not need the data at a
sub-second or second-level. We can summarize the data at a daily level
using the <code>ww_summarize_sensorlog</code> function. This function
will take the mean over a period of seconds, usually 60:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_min</span> <span class="op">=</span> <span class="fu"><a href="../reference/ww_summarize_sensorlog.html">ww_minute_sensorlog</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df_min</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 16</span></span></span>
<span><span class="co">#&gt;   time                max_speed   lat   lon speed accel_X accel_Y accel_Z</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>                  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 2025-03-11 <span style="color: #949494;">18:44:00</span>        -<span style="color: #BB0000;">1</span>  39.3 -<span style="color: #BB0000;">76.6</span>    -<span style="color: #BB0000;">1</span> -<span style="color: #BB0000;">0.017</span><span style="color: #BB0000; text-decoration: underline;">8</span>   0.964  0.018<span style="text-decoration: underline;">2</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 2025-03-11 <span style="color: #949494;">18:45:00</span>        -<span style="color: #BB0000;">1</span>  39.3 -<span style="color: #BB0000;">76.6</span>    -<span style="color: #BB0000;">1</span> -<span style="color: #BB0000;">0.066</span><span style="color: #BB0000; text-decoration: underline;">5</span>   1.01   0.057<span style="text-decoration: underline;">7</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 2025-03-11 <span style="color: #949494;">18:46:00</span>        -<span style="color: #BB0000;">1</span>  39.3 -<span style="color: #BB0000;">76.6</span>    -<span style="color: #BB0000;">1</span> -<span style="color: #BB0000;">0.054</span><span style="color: #BB0000; text-decoration: underline;">7</span>   1.00   0.025<span style="text-decoration: underline;">0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 2025-03-11 <span style="color: #949494;">18:47:00</span>        -<span style="color: #BB0000;">1</span>  39.3 -<span style="color: #BB0000;">76.6</span>    -<span style="color: #BB0000;">1</span> -<span style="color: #BB0000;">0.084</span><span style="color: #BB0000; text-decoration: underline;">3</span>   1.01   0.045<span style="text-decoration: underline;">0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 2025-03-11 <span style="color: #949494;">18:48:00</span>        -<span style="color: #BB0000;">1</span>  39.3 -<span style="color: #BB0000;">76.6</span>    -<span style="color: #BB0000;">1</span> -<span style="color: #BB0000;">0.080</span><span style="color: #BB0000; text-decoration: underline;">8</span>   1.01   0.046<span style="text-decoration: underline;">8</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 2025-03-11 <span style="color: #949494;">18:49:00</span>        -<span style="color: #BB0000;">1</span>  39.3 -<span style="color: #BB0000;">76.6</span>    -<span style="color: #BB0000;">1</span> -<span style="color: #BB0000;">0.090</span><span style="color: #BB0000; text-decoration: underline;">1</span>   1.01   0.041<span style="text-decoration: underline;">1</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 8 more variables: distance &lt;dbl&gt;, is_within_home &lt;lgl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   distance_traveled &lt;dbl&gt;, vm &lt;dbl&gt;, enmo &lt;dbl&gt;, lat_zero &lt;lgl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   lon_zero &lt;lgl&gt;, in_sensorlog &lt;lgl&gt;</span></span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_sum</span> <span class="op">=</span> <span class="fu"><a href="../reference/ww_summarize_sensorlog.html">ww_summarize_sensorlog</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="va">df_sum</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 10</span></span></span>
<span><span class="co">#&gt;   date       n_minutes_with_distance sum_distance max_distance</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>                       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 2025-03-11                      12         880.         73.3</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 6 more variables: sum_distance_traveled &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   mean_distance_traveled &lt;dbl&gt;, n_distance_traveled &lt;int&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   time_within_home &lt;int&gt;, time_outside_home &lt;int&gt;, time_missing_home &lt;int&gt;</span></span></span></code></pre></div>
<div class="section level4">
<h4 id="reading-in-the-gt3x-data">Reading in the GT3X data<a class="anchor" aria-label="anchor" href="#reading-in-the-gt3x-data"></a>
</h4>
<p>To also summarize the activity profile for different levels of
proximity to a fixed point we will read in the GT 3X data. This data was
captured using an ActiGraph (Pensacola FL) GT9X device. We can read in
the data using the <code>read.gt3x</code> package. The data is stored in
the <code>extdata</code> folder of the package, similar to the SensorLog
data. The <code>imputeZeroes</code> option will put the acceleration as
0 for any rows that are missing, likely due to idle sleep mode. The
<code>asDataFrame</code> option will return the data as a data frame
with the time (in GMT):</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">file_gt3x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"TAS1H30182789_2025-03-11.gt3x"</span>, package <span class="op">=</span> <span class="st">"waterways"</span><span class="op">)</span></span>
<span><span class="va">ag</span> <span class="op">=</span> <span class="fu">read.gt3x</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/read.gt3x/man/read.gt3x.html" class="external-link">read.gt3x</a></span><span class="op">(</span><span class="va">file_gt3x</span>, imputeZeroes <span class="op">=</span> <span class="cn">TRUE</span>, asDataFrame <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ag</span><span class="op">)</span></span>
<span><span class="co">#&gt; Sampling Rate: 80Hz</span></span>
<span><span class="co">#&gt; Firmware Version: 1.7.2</span></span>
<span><span class="co">#&gt; Serial Number Prefix: TAS</span></span>
<span><span class="co">#&gt;                  time      X     Y     Z</span></span>
<span><span class="co">#&gt; 1 2025-03-11 13:45:00 -0.270 0.910 0.352</span></span>
<span><span class="co">#&gt; 2 2025-03-11 13:45:00 -0.266 0.895 0.359</span></span>
<span><span class="co">#&gt; 3 2025-03-11 13:45:00 -0.270 0.887 0.375</span></span>
<span><span class="co">#&gt; 4 2025-03-11 13:45:00 -0.281 0.875 0.391</span></span>
<span><span class="co">#&gt; 5 2025-03-11 13:45:00 -0.289 0.863 0.406</span></span>
<span><span class="co">#&gt; 6 2025-03-11 13:45:00 -0.285 0.859 0.418</span></span></code></pre></div>
<p>Note that the time is in GMT. We can check the timezone of the data
using the <code><a href="https://lubridate.tidyverse.org/reference/tz.html" class="external-link">lubridate::tz</a></code> function:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/tz.html" class="external-link">tz</a></span><span class="op">(</span><span class="va">ag</span><span class="op">$</span><span class="va">time</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "GMT"</span></span></code></pre></div>
<p>This is misleading, as is noted in <code>read.gt3x</code>: &gt;
DateTimes are therefore represented as POSIXct format with the ‘GMT’
timezone attribute, which is false; the datetime actually represents
local time.</p>
<p>We can confirm this via the header:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">header</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">ag</span><span class="op">)</span><span class="op">$</span><span class="va">header</span></span>
<span><span class="va">header</span></span>
<span><span class="co">#&gt; GT3X information</span></span>
<span><span class="co">#&gt;  $ Serial Number     :"TAS1H30182789"</span></span>
<span><span class="co">#&gt;  $ Device Type       :"Link"</span></span>
<span><span class="co">#&gt;  $ Firmware          :"1.7.2"</span></span>
<span><span class="co">#&gt;  $ Battery Voltage   :"4.17"</span></span>
<span><span class="co">#&gt;  $ Sample Rate       :80</span></span>
<span><span class="co">#&gt;  $ Start Date        : POSIXct, format: "2025-03-11 13:45:00"</span></span>
<span><span class="co">#&gt;  $ Stop Date         : POSIXct, format: "1-01-01"</span></span>
<span><span class="co">#&gt;  $ Last Sample Time  : POSIXct, format: "2025-03-11 15:43:15"</span></span>
<span><span class="co">#&gt;  $ TimeZone          :"-04:00:00"</span></span>
<span><span class="co">#&gt;  $ Download Date     : POSIXct, format: "2025-03-11 15:43:15"</span></span>
<span><span class="co">#&gt;  $ Board Revision    :"8"</span></span>
<span><span class="co">#&gt;  $ Unexpected Resets :"0"</span></span>
<span><span class="co">#&gt;  $ Acceleration Scale:256</span></span>
<span><span class="co">#&gt;  $ Acceleration Min  :"-8.0"</span></span>
<span><span class="co">#&gt;  $ Acceleration Max  :"8.0"</span></span>
<span><span class="co">#&gt;  $ Sex               :"Male"</span></span>
<span><span class="co">#&gt;  $ Race              :"White / Caucasian"</span></span>
<span><span class="co">#&gt;  $ Limb              :"Wrist"</span></span>
<span><span class="co">#&gt;  $ Side              :"Left"</span></span>
<span><span class="co">#&gt;  $ Dominance         :"Non-Dominant"</span></span>
<span><span class="co">#&gt;  $ Subject Name      :"John"</span></span>
<span><span class="co">#&gt;  $ Serial Prefix     :"TAS"</span></span>
<span><span class="va">header</span><span class="op">$</span><span class="va">TimeZone</span></span>
<span><span class="co">#&gt; [1] "-04:00:00"</span></span></code></pre></div>
<p>Thus, we will set the timezone to be <code>GMT</code> using the
<code><a href="https://lubridate.tidyverse.org/reference/force_tz.html" class="external-link">lubridate::force_tz</a></code> function:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ag</span><span class="op">$</span><span class="va">time</span> <span class="op">=</span> <span class="fu">force_tz</span><span class="op">(</span><span class="fu">with_tz</span><span class="op">(</span><span class="va">ag</span><span class="op">$</span><span class="va">time</span>, <span class="st">"Etc/GMT-4"</span><span class="op">)</span>, <span class="st">"GMT"</span><span class="op">)</span></span>
<span><span class="va">ag</span></span>
<span><span class="co">#&gt; Sampling Rate: 80Hz</span></span>
<span><span class="co">#&gt; Firmware Version: 1.7.2</span></span>
<span><span class="co">#&gt; Serial Number Prefix: TAS</span></span>
<span><span class="co">#&gt;                  time      X     Y     Z</span></span>
<span><span class="co">#&gt; 1 2025-03-11 17:45:00 -0.270 0.910 0.352</span></span>
<span><span class="co">#&gt; 2 2025-03-11 17:45:00 -0.266 0.895 0.359</span></span>
<span><span class="co">#&gt; 3 2025-03-11 17:45:00 -0.270 0.887 0.375</span></span>
<span><span class="co">#&gt; 4 2025-03-11 17:45:00 -0.281 0.875 0.391</span></span>
<span><span class="co">#&gt; 5 2025-03-11 17:45:00 -0.289 0.863 0.406</span></span>
<span><span class="co">#&gt; 6 2025-03-11 17:45:00 -0.285 0.859 0.418</span></span></code></pre></div>
<p>We can create a general solution for this</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tzoffset_to_tz</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">":00"</span>, <span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">":00:00$"</span>, <span class="st">""</span>, <span class="va">x</span><span class="op">)</span></span>
<span>  <span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">":00$"</span>, <span class="st">""</span>, <span class="va">x</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&lt;=</span> <span class="fl">3</span><span class="op">)</span></span>
<span>  <span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">x</span> <span class="op">&gt;</span> <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"+"</span>, <span class="va">x</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Etc/GMT"</span>, <span class="va">x</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="va">x</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/timezones.html" class="external-link">OlsonNames</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">x</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">tzoffset_to_tz</span><span class="op">(</span><span class="va">header</span><span class="op">$</span><span class="va">TimeZone</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Etc/GMT-4"</span></span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ag</span> <span class="op">=</span> <span class="va">ag</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>idle <span class="op">=</span> <span class="va">X</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="va">Y</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="va">Z</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">ag</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">idle</span><span class="op">)</span></span>
<span><span class="co">#&gt; Sampling Rate: Hz</span></span>
<span><span class="co">#&gt; Firmware Version: </span></span>
<span><span class="co">#&gt; Serial Number Prefix: </span></span>
<span><span class="co">#&gt;                  time X Y Z idle</span></span>
<span><span class="co">#&gt; 1 2025-03-11 18:57:28 0 0 0 TRUE</span></span>
<span><span class="co">#&gt; 2 2025-03-11 18:57:28 0 0 0 TRUE</span></span>
<span><span class="co">#&gt; 3 2025-03-11 18:57:28 0 0 0 TRUE</span></span>
<span><span class="co">#&gt; 4 2025-03-11 18:57:28 0 0 0 TRUE</span></span>
<span><span class="co">#&gt; 5 2025-03-11 18:57:28 0 0 0 TRUE</span></span>
<span><span class="co">#&gt; 6 2025-03-11 18:57:28 0 0 0 TRUE</span></span></code></pre></div>
<p>In ActiLife, the ActiGraph software, values of zero for all axes are
set to the last observation carried forward (LOCF). The
<code><a href="http://johnmuschelli.com/SummarizedActigraphy/reference/fix_zeros.html" class="external-link">SummarizedActigraphy::fix_zeros</a></code> will fill in these zero
values:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ag</span> <span class="op">=</span> <span class="fu">SummarizedActigraphy</span><span class="fu">::</span><span class="fu"><a href="http://johnmuschelli.com/SummarizedActigraphy/reference/fix_zeros.html" class="external-link">fix_zeros</a></span><span class="op">(</span><span class="va">ag</span><span class="op">)</span></span>
<span><span class="va">ag</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">idle</span><span class="op">)</span></span>
<span><span class="co">#&gt; Sampling Rate: Hz</span></span>
<span><span class="co">#&gt; Firmware Version: </span></span>
<span><span class="co">#&gt; Serial Number Prefix: </span></span>
<span><span class="co">#&gt;                  time      X      Y     Z idle</span></span>
<span><span class="co">#&gt; 1 2025-03-11 18:57:28 -0.027 -1.023 0.008 TRUE</span></span>
<span><span class="co">#&gt; 2 2025-03-11 18:57:28 -0.027 -1.023 0.008 TRUE</span></span>
<span><span class="co">#&gt; 3 2025-03-11 18:57:28 -0.027 -1.023 0.008 TRUE</span></span>
<span><span class="co">#&gt; 4 2025-03-11 18:57:28 -0.027 -1.023 0.008 TRUE</span></span>
<span><span class="co">#&gt; 5 2025-03-11 18:57:28 -0.027 -1.023 0.008 TRUE</span></span>
<span><span class="co">#&gt; 6 2025-03-11 18:57:28 -0.027 -1.023 0.008 TRUE</span></span></code></pre></div>
<p>We can calculate a number of summary measures from the acceleration.
We will calculate ActiGraph Activity Counts using the
<code>agcounts</code> package. We will use the <code>epoch = 60</code>
to calculate the counts in 60-second epochs. We will also set the
timezone to be <code>GMT</code> to match the SensorLog data:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">counts</span> <span class="op">=</span> <span class="fu">agcounts</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/agcounts/man/calculate_counts.html" class="external-link">calculate_counts</a></span><span class="op">(</span><span class="va">ag</span>, epoch <span class="op">=</span> <span class="fl">60</span>, tz <span class="op">=</span> <span class="st">"GMT"</span><span class="op">)</span></span>
<span><span class="va">counts</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;                  time Axis1 Axis2 Axis3 Vector.Magnitude</span></span>
<span><span class="co">#&gt; 1 2025-03-11 17:45:00  1067  1225  1235             2041</span></span>
<span><span class="co">#&gt; 2 2025-03-11 17:46:00  1004   772  1048             1644</span></span>
<span><span class="co">#&gt; 3 2025-03-11 17:47:00   129    11   189              229</span></span>
<span><span class="co">#&gt; 4 2025-03-11 17:48:00  1541  1017  2129             2818</span></span>
<span><span class="co">#&gt; 5 2025-03-11 17:49:00   676   575   619             1082</span></span>
<span><span class="co">#&gt; 6 2025-03-11 17:50:00    72    79    68              127</span></span>
<span><span class="va">counts</span> <span class="op">=</span> <span class="va">counts</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">time</span>, counts <span class="op">=</span> <span class="va">Vector.Magnitude</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="overlap-with-sensorlog-data">Overlap with SensorLog data<a class="anchor" aria-label="anchor" href="#overlap-with-sensorlog-data"></a>
</h4>
<p>The SensorLog data used was a subset of the data from the ActiGraph
data and multiple recordings were done.</p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by John Muschelli.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
